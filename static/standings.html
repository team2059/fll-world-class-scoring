<!DOCTYPE html>
<html>
    <head lang="en">
        <meta charset="UTF-8">
        <title>Current Standings</title>
        <style>
            td {
                width: 20%;
            }
            th {
                width: 20%;
            }
        </style>
        <script src="/socket.io/socket.io.js"></script>
        <script>
            var socket = io();
            socket.on('update', function(msg) {
                var data = JSON.parse(msg);
                document.getElementById('score-'+data.table).textContent = data["score"];
                document.getElementById('team-'+data.table).textContent = data["team"];
            });
            function updateRankings(){
                var table = document.getElementById("rankings");
                table.innerHTML='<tr><th colspan="3">Standings</th></tr><tr><th>Rank</th><th>Team</th><th>Score</th></tr>';
                function updateTable(){
                    var rankings = JSON.parse(this.responseText);
                    console.log(rankings);
                    for (var x = 0; x < rankings.length; x++){
                        var newLine = document.createElement('tr');
                        var newTeam = document.createElement('td');
                        newTeam.textContent = rankings[x]["team"];
                        var newRank = document.createElement('td');
                        newRank.textContent = x+1;
                        var newScore = document.createElement('td');
                        newScore.textContent = rankings[x]["score"];
                        newLine.appendChild(newRank);
                        newLine.appendChild(newTeam);
                        newLine.appendChild(newScore);
                        table.getElementsByTagName('tbody')[0].appendChild(newLine);
                        console.log(newLine);
                    }
                }
                var xmlhttp = new XMLHttpRequest();
                xmlhttp.open("get","/rankings",true);
                xmlhttp.onload = updateTable;
                xmlhttp.send()
            }
        </script>
    </head>
    <body>
        <table id="current">
            <tr><th colspan="5">Current Runs</th></tr>
            <tr><th>Table</th><td>A</td><td>B</td><td>C</td><td>D</td></tr>
            <tr><th>Team</th><td id="team-a">0</td><td id="team-b">0</td><td id="team-c">0</td><td id="team-d">0</td></tr>
            <tr><th>Score</th><td id="score-a">0</td><td id="score-b">0</td><td id="score-c">0</td><td id="score-d">0</td></tr>            
        </table>
        <table id="rankings">         
        </table>
    </body>
    <script>updateRankings();</script>
</html>